# AI Opportunity Finder 监控管理系统

## 🎯 功能概述

我们为您创建了一个功能完整的AI Opportunity Finder监控管理页面，可以通过可视化界面实时查看爬虫运行情况，并提供智能通知提醒功能。

## 📋 核心功能

### 1. 🔍 系统概览监控
- **服务状态**: 实时显示爬虫服务运行状态
- **成功率统计**: 显示抓取成功率和总体统计
- **错误率监控**: 监控系统错误率，及时发现问题
- **机会发现统计**: 展示本周新发现的机会数量

### 2. 🌐 数据源状态监控
- **多源监控**: Reddit、HackerNews、Newsletter、G2、LinkedIn
- **实时状态**: 显示每个数据源的连接状态和错误信息
- **响应时间**: 监控各数据源的响应速度
- **单独触发**: 可单独触发某个数据源的抓取任务

### 3. 📊 系统连接监控
- **Kafka消息队列**: 实时监控消息队列连接状态
- **Qdrant向量库**: 检查向量数据库连接
- **Embedding服务**: 监控文本向量化服务状态
- **数据流指标**: 显示消息生产/处理/存储统计

### 4. 📝 实时日志查看
- **多服务日志**: 聚合所有微服务的日志信息
- **分级显示**: INFO/WARNING/ERROR 分级显示
- **实时更新**: 30秒自动刷新，获取最新日志
- **时间戳**: 精确显示日志产生时间

### 5. 🔔 智能通知系统
- **浏览器通知**: 支持桌面推送通知
- **Slack集成**: 配置Webhook自动发送告警到Slack
- **阈值设置**: 自定义错误率和成功率告警阈值
- **测试功能**: 一键测试通知配置是否正常

## 🚀 使用方法

### 启动监控界面

1. **快速启动演示**:
```bash
./start-monitor-demo.sh
```

2. **手动启动**:
```bash
cd apps/web
npm run dev
```

3. **访问管理界面**:
- 前端地址: http://localhost:5173
- 管理页面: http://localhost:5173/admin/opportunity-finder

### 配置通知系统

1. **启用浏览器通知**:
   - 首次访问会请求通知权限
   - 允许后即可接收桌面通知

2. **配置Slack通知**:
   - 在Slack中创建Webhook URL
   - 在"通知设置"标签页中填入Webhook URL
   - 点击"测试通知"验证配置
   - 设置错误率和成功率阈值

3. **自定义告警规则**:
   - 错误率阈值: 当错误率超过设定值时告警
   - 成功率阈值: 当成功率低于设定值时告警
   - 系统状态异常时自动告警

## 📁 文件结构

```
apps/web/src/
├── pages/
│   └── AdminOpportunityFinderPage.tsx    # 主监控页面
├── lib/
│   └── opportunity-finder-monitor.ts     # API客户端
├── components/
│   ├── AdminSidebar.tsx                  # 管理菜单(已更新)
│   └── NotificationSystem.tsx            # 通知系统组件
└── App.tsx                               # 路由配置(已更新)
```

## 🔧 后端连接

### API端点配置
监控系统会自动连接到以下端点:
- **开发环境**: http://localhost:8081/api/v1
- **生产环境**: https://api.deepneed.com/opportunity-finder

### Mock数据支持
当后端不可用时，系统自动切换到Mock数据模式，确保界面正常工作。

### 实际端点 (当后端运行时)
- `/monitor/status` - 获取爬虫整体状态
- `/monitor/sources` - 获取数据源状态
- `/monitor/metrics` - 获取系统指标
- `/monitor/logs` - 获取实时日志
- `/monitor/trigger-crawl` - 手动触发抓取

## 📊 监控指标说明

### 核心指标
- **服务状态**: running/stopped
- **运行时长**: 自启动以来的时间
- **成功率**: 成功抓取 / 总抓取次数
- **错误率**: 失败抓取 / 总抓取次数

### 数据源状态
- **success**: 数据源正常工作
- **warning**: 有警告但仍可用 (如需要API密钥)
- **error**: 数据源不可用

### 系统连接
- **Kafka**: 消息队列连接状态
- **Qdrant**: 向量数据库连接状态  
- **Embedding**: 文本向量化服务状态

## 🚨 告警规则

### 自动告警条件
1. **服务停止**: 爬虫服务停止运行
2. **高错误率**: 错误率超过设定阈值(默认70%)
3. **低成功率**: 成功率低于设定阈值(默认30%)
4. **连接中断**: Kafka或Qdrant连接中断

### 通知渠道
1. **浏览器通知**: 即时桌面推送
2. **Slack通知**: 发送到指定频道
3. **界面提示**: 页面顶部警告横幅

## 💡 使用建议

### 日常监控
1. **定期检查**: 建议每日查看一次系统状态
2. **关注错误率**: 重点关注错误率变化趋势
3. **日志分析**: 定期查看错误日志，优化配置

### 问题排查
1. **服务状态**: 首先检查各服务是否运行
2. **网络连接**: 验证各数据源的网络连接
3. **日志分析**: 查看具体错误信息
4. **手动测试**: 使用"触发抓取"功能测试

### 性能优化
1. **监控响应时间**: 关注各数据源响应速度
2. **处理速率**: 监控消息处理速率
3. **存储容量**: 关注向量存储增长情况

## 🔄 实时更新

- **自动刷新**: 30秒自动更新数据
- **手动刷新**: 点击"刷新数据"按钮
- **实时开关**: 可开启/关闭实时更新模式

## 🎨 界面特点

- **响应式设计**: 支持桌面和移动设备
- **暗色主题**: 符合现代管理界面设计
- **动画效果**: 流畅的页面切换和状态变化
- **图标指示**: 直观的状态图标和颜色编码

## 🔐 权限管理

- 集成到现有的DeepNeed管理系统
- 需要管理员权限才能访问
- 支持角色权限控制 (未来扩展)

---

## 🎯 总结

这个监控管理系统为您提供了完整的AI Opportunity Finder运维能力:

✅ **可视化监控** - 直观查看所有系统状态  
✅ **实时告警** - 及时发现和处理问题  
✅ **便捷操作** - 一键触发抓取和测试  
✅ **详细日志** - 完整的故障排查信息  
✅ **智能通知** - 多渠道告警提醒  

现在您可以通过这个专业的管理界面，轻松监控和管理您的AI机会发现系统！